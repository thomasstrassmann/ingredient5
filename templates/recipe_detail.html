{% extends 'base.html' %}
{% load static %}

{% block content %}
<section class="recipe-hero" aria-label="recipe image">
  <div class="recipe-hero-image" style="background-image: url('{% static 'img/recipes/' %}{{ recipe.slug }}.jpg')">
    <div class="recipe-hero-container">
      <div class="recipe-hero-text">
        <h1>{{ recipe.title }}</h1>
      </div>
    </div>
  </div>
</section>

<section class="recipe-details" aria-label="recipe details">
  <div>
    <p>{{ recipe.type }}</p>
    {% if recipe.vegetarian %}
    <span class="vegetarian">
      <p>Vegetarian</p>
      <img src="{% static 'img/icons/veggie.svg' %}" alt="vegetarian">
    </span>
    {% endif %}
    <p>{{ recipe.created }}</p>
  </div>
</section>


<p>{{ recipe.content | safe }}</p>

{% if user.is_authenticated %}
<form action="{% url 'recipe_bookmark' recipe.slug %}" method="POST">
  {% csrf_token %}
  {% if liked %}
  <button type="submit" name="recipe_id" value="{{recipe.slug}}">Bookmarked FA</button>
  {% else %}
  <button type="submit" name="recipe_id" value="{{recipe.slug}}">Not bookmarked</button>
  {% endif %}
  <span> {{ recipe.num_of_bookmarks }} </span>
  {% endif %}
</form>

<div>
  {% with comments.count as total %}
  <strong><i class="far fa-comments"></i> {{ total }}</strong>
  {% endwith %}
</div>

<div>
  <h3>Comments:</h3>
  <div>
    {% for comment in comments %}
    <div>
      <p>
        {{ comment.username }}
        <span> {{ comment.created }} </span> wrote:
      </p>
      {{ comment.message }}
    </div>
    {% endfor %}
  </div>
</div>

<div>
  {% if commented %}
  <div>
    <p>
      We are currently checking your comment, please wait a few minutes for
      approval!
    </p>
  </div>
  {% else %} {% if user.is_authenticated %}

  <h3>Post your comment right here:</h3>
  <p>{{ user.username }} says:</p>
  <form method="post">
    {{ comment_form }} {% csrf_token %}
    <button type="submit">Submit</button>
  </form>
  {% endif %}
  {% endif %}
</div>
{% endblock content %}